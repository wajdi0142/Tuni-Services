<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Connexion Fournisseur - Tuni-Services</title>

  <!-- Bootstrap 5 + Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />

  <!-- Police premium -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />

  <!-- Ton CSS principal (le dernier qu’on a fait ensemble) -->
  <link rel="stylesheet" href="../assets/css/style.css" />
  
  <style>
    /* --- GLOBAL UI --- */
body {
  background: linear-gradient(135deg, #f2f4ff 0%, #e8edff 100%);
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: "Inter", sans-serif;
}

.login-card {
  background: #ffffff;
  border-radius: 32px;
  box-shadow: 0 35px 80px rgba(30, 42, 94, 0.18);
  overflow: hidden;
  animation: fadeInUp 0.8s ease-out;
  max-width: 430px;
}

/* --- HEADER GRADIENT --- */
.login-header {
  background: linear-gradient(135deg, #1E2A5E, #4A7BFA);
  padding: 2.7rem 2rem 2.3rem;
  text-align: center;
  color: white;
}

.login-header img {
  height: 70px;
  filter: drop-shadow(0 4px 14px rgba(0, 0, 0, 0.35));
  margin-bottom: 1rem;
  transition: 0.4s ease;
}

.login-header img:hover {
  transform: scale(1.07);
}

/* --- INPUTS PREMIUM --- */
.form-control {
  border-radius: 18px;
  padding: 1rem 1.2rem;
  background: #f7f7fb;
  border: 2px solid #e2e4f0;
  transition: all 0.3s ease-out;
  font-size: 1.07rem;
}

.form-control:focus {
  border-color: #4A7BFA;
  background: #ffffff;
  box-shadow: 0 0 0 6px rgba(74, 123, 250, 0.18);
}

/* Icônes */
.input-group-text {
  background: #ffffff;
  border-radius: 16px;
  border: 2px solid #e2e4f0;
}

/* --- BOUTON PRINCIPAL (SE CONNECTER) --- */
.btn-login {
  background: linear-gradient(135deg, #1E2A5E, #4A7BFA);
  color: white;
  font-weight: 700;
  padding: 1rem;
  border-radius: 50px;
  font-size: 1.12rem;
  letter-spacing: 0.3px;
  transition: all 0.35s ease;
  box-shadow: 0 8px 25px rgba(74, 123, 250, 0.35);
}

.btn-login:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 20px 40px rgba(74, 123, 250, 0.45);
  background: linear-gradient(135deg, #4A7BFA, #1E2A5E);
}

/* --- BOUTON CREATE ACCOUNT --- */
.btn-signup {
  background: #ffffff;
  color: #1E2A5E;
  font-weight: 700;
  border-radius: 20px;
  border: 2px solid #d4d8e5;
  transition: 0.3s ease-in-out;
}

.btn-signup:hover {
  background: #1E2A5E;
  border-color: #1E2A5E;
  color: #ffffff;
  box-shadow: 0 12px 30px rgba(30, 42, 94, 0.3);
}

/* --- BOUTON “Retour accueil” --- */
.btn-outline-secondary {
  border-radius: 50px;
  padding: 0.5rem 1.4rem;
  transition: 0.3s ease;
  border: 2px solid #cfd3dd;
  color: #444;
}

.btn-outline-secondary:hover {
  background: #4A7BFA;
  color: #fff;
  box-shadow: 0 10px 25px rgba(74, 123, 250, 0.35);
}

/* --- MODAL --- */
.modal-content {
  border-radius: 26px !important;
  overflow: hidden;
}

.modal-header {
  background: linear-gradient(135deg, #1E2A5E, #4A7BFA) !important;
}

/* --- ANIMATION --- */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(40px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

  </style>
</head>
<body>

  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-md-6 col-lg-5 col-xl-4">

        <div class="login-card">
          <!-- Header bleu dégradé -->
          <div class="login-header">
            <img src="../assets/img/logo.png" alt="Tuni-Services" />
            <h3 class="fw-bold mb-0">Connexion Fournisseur</h3>
            <p class="opacity-90 small mt-2">Accédez à votre espace pro</p>
          </div>

          <!-- Formulaire -->
          <div class="p-4 p-md-5">
            <form id="loginForm" novalidate>
              <div class="mb-4">
                <label class="form-label fw-600 text-dark">Email</label>
                <div class="input-group input-group-lg">
                  <span class="input-group-text bg-white border-0"><i class="fas fa-envelope text-primary"></i></span>
                  <input type="email" id="email" class="form-control" placeholder="votre@email.com" required />
                </div>
              </div>

              <div class="mb-4">
                <label class="form-label fw-600 text-dark">Mot de passe</label>
                <div class="input-group input-group-lg">
                  <span class="input-group-text bg-white border-0"><i class="fas fa-lock text-primary"></i></span>
                  <input type="password" id="password" class="form-control" minlength="6" required />
                  <button type="button" class="btn btn-outline-secondary border-0" id="togglePassword">
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
              </div>

              <button type="submit" class="btn btn-login btn-lg w-100 mb-4">
                <span class="spinner-border spinner-border-sm me-2 d-none" id="loading"></span>
                Se connecter
              </button>

              <!-- Liens -->
              <div class="text-center">
                <a href="forgot-password.html" class="link-primary small d-block mb-2">
                  Mot de passe oublié ?
                </a>
                <a href="#" class="btn btn-signup w-100 mb-3" data-bs-toggle="modal" data-bs-target="#signupModal">
                  Créer un compte fournisseur
                </a>
                <a href="../index.html" class="btn btn-outline-secondary btn-sm rounded-pill px-4">
                  <i class="fas fa-home"></i> Retour à l'accueil
                </a>
              </div>
            </form>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- Modal Inscription -->
  <div class="modal fade" id="signupModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg" style="border-radius: 20px;">
        <div class="modal-header border-0 bg-primary text-white">
          <h5 class="modal-title">Créer un compte fournisseur</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-4">
          <form id="registerForm">
            <div class="mb-3">
              <input type="text" class="form-control form-control-lg" placeholder="Nom complet" id="regName" required />
            </div>
            <div class="mb-3">
              <input type="email" class="form-control form-control-lg" placeholder="Email professionnel" id="regEmail" required />
            </div>
            <div class="mb-3">
              <input type="text" class="form-control form-control-lg" placeholder="Téléphone (+216)" id="regPhone" />
            </div>
            <div class="mb-4">
              <input type="password" class="form-control form-control-lg" placeholder="Mot de passe (6+ caractères)" id="regPassword" minlength="6" required />
            </div>
            <button type="submit" class="btn btn-primary btn-lg w-100 rounded-pill">
              S'inscrire gratuitement
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast succès -->
  <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1100;">
    <div id="loginToast" class="toast align-items-center text-white bg-success border-0" role="alert">
      <div class="d-flex">
        <div class="toast-body fw-bold">Connexion réussie ! Redirection...</div>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/js/script.js"></script>
  <!-- SÉCURITÉ : vérification session + anti-retour -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      fetch("../api/check-session.php")
        .then(res => res.json())
        .then(data => {
          if (data.loggedIn) {
            window.location.href = "dashboard.php";
          }
        });
    });

    // Bloque le bouton retour après déconnexion
    if (performance.navigation.type === 2) {
      window.location.href = "login.html";
    }
    window.addEventListener('pageshow', e => {
      if (e.persisted) window.location.reload();
    });
  </script>
</body>
</html>